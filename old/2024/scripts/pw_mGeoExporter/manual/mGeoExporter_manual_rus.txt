Руководство mGeo Exporter v1.0

Назначение.

    Скрипт mGeo Exporter предназначен для экспорта полигонов, NURBS кривых и частиц в Houdini. 

Основные возможности:
    - Работа с форматом JSON GEO и автоматическое конвертирование в BGEO с помощью утилиты gconvert, идущей в поставке с Houdini
    - Запись полигонов, NURBS кривых и частиц с возможностью сохранить все типы в один файл
    - Режим Pivots запиcывает любые DAG объекты как точка с атрибутами orient и scale. Позволяет упростить и облегчить передачу копированных и инстансированных объектов
    - Запись анимации в MDD формат или секвенцию файлов
    - Возможность генерировать на объектах и точках группы по различным алгоритмам
    - Cохранение всех настроек экспорта в сцене в виде экспортных сетов

Возможности при записи геометрии.
    Полигоны:
        Создание примитивных групп по нескольким алгоритмам: 
            назначенный материал
            имя объекта
            имя шейп-ноды
            имя родительской ноды
            имя слоя
        Чтение любых атрибутов и запись их как примитивные атрибуты.
        Экспорт вертексных атрибутов: UV, Vertex Color, Vertex Normal, Edge Crease
    Кривые:
        Экспорт кривых как NURBS или Poly Line
        Сохранение примитивных групп по нескольким алгоритмам:
            имя объекта
            имя родительской ноды
            имя слоя
    Частицы:
        Запись любых атрибутов с частиц или с ноды системы частиц
        Создание поинт-групп по имени объекта или эмиттеру
    Пивоты
        запись любых атрибутов с объекта как атрибут точки
        зпись вращения и масштаба как orient и scale, готовые атрибуты для использования в CopySOP
    Запись пивотов в группы по нескольким алгоритмам:
            имя объекта
            имя шейп-ноды
            имя родительской ноды

Руководство ----------------------------------------------

Скрипт предзанзначен для экспорта данных из Maya в Houdini. Поддерживается запись полигональных объектов, NURBS кривых и частиц. Кроме того можно записать любой DAG объект как точку, с атрибутами. любые атрибуты могут быть считаны с записываемого объекта и записаны как атрибут точки. Это дает возможность делать спецефические риги с быстрым обновлением данных после изменений. Примеры можно увидеть в видеоуроках. При записи геометрии есть возможность генерировать примитивные и поинтовые группы по нескольким алгоритмам, таким как присвоенный материал или имя объекта. Все данные скрипт пишет в нативный для Houdini формат - JSON GEO. Так же есть возможность автоматически конвертировать файлы geo в bgeo (требуется установленный Houdini)
            
1. Описание опций интерфейса

1.1 Группа Formats
    Format file
        Выбор формата записываемого файла. Поддерживается два типа, GEO и BGEO. Так же есть возможность  использовать ZIP архивацию. В любом лучае, Houdini считывает такие форматы без дополнительных стредств (FileSOP). Для записи в BGEO требется установленный Houdini, так как используется утилита gconvert, идущую в поставке с ним
    Cache
        Выбор метода записи анимации. Есть два варианта: запись каждого кадра в отдельный файл (sequence), или запись одного файла геометрии + анимация точек в файле поинткеша формата MDD. Этот тип кеша так же может быть прочитан в Houdini без дополнительных средств (MddSOP)
    Write geometry
        Опция, отключающая запись геометрии в режиме записи MDD кеша. То есть, будет записана только анимация точек, файл геометрии не перезаписывается
    
1.2 Группа Frame Range
    Single
        Этот режим означает, что сцена будет записана в один файл в текущем состоянии в текущем кадре
    Range
        Этот режим позволяет записать анимацию в указанном диапазоне кадров. Если режим записи анимации устеновлен на Sequence, то по умолчанию паддинг выставлен в $F5. В имени файла можно вручную указать паддинг в формате $FN, где N это размер паддинга для номера кадра
    << 
        Установить диапазон кадров из текущего состояния таймлайна
    
1.3 Группа Output file
    В основной строке необходимо записать адрес файла, в который будет произведена запись. Расширение будет выставленно автоматически исходя из настроек сета, но окончательное имя файла будет написано в окне output после записи файла. Поддерживается запись $FN, где N это размер паддинга для номер кадра (работает так же как в Houdini). Например "c:/export/file_$F4"
    Варианты действия при наличии файла с указанным именем на диске
    Ask
        Если файл уже есть на диске, будет выдан запрос на изменение имени файла
    Overwrite
        Файлы автоматически перезаписываются. Установлено по умолчанию
    Skip
        Пропустить запись файла если он уже есть
    Rename
        Автоматически переименовывает файл, добавляя цифру к имени или наращивая значение имеющейся цифры. Формат name_##.ext
    
1.4 Группа Export Sets
    Create new export set from selection
        Создает новый экспортный сет из выделенных объектов.
    Remove set
        Удаляет выбранные сеты. Так же можно удалить соответствующие ноды в оутлайнере
    Add selected objects to set
        Добавляет выбранные объекты в выделенные сеты. Так же можно перетащить соответствующие ноды в сет используя оутлайнер
    Remove selected objects from set
        Удаляет выбранные объекты из выделенных сетов
    Replace all objects in set to the selected
        Очищает выделенные сеты и добавляет в них выделенные объекты
    Clear Set
        Очищает выбранные сеты
        
1.4.1 Окно со списком сетов
    Это окно содержит сеты, находящиеся в сцене. Оранжевая кнопка слева активирует или деактивирует сет. Если кнопка серая, сет не будет экспортироваться. Клик по пустому полю списка обновляет список. Например после того, как были удалены ноды сетов вручную из оутлайнера.
    
1.4.2 Контекстное меню для сетов:
    Copy
        Копирует параметры сета во временную переменную
    Paste
        Применяет параметры к выделенным сетам из временной переменной
    Rename
        Переименование сета
    Duplicate
        Полностью дублирет выбранные сеты, включая содержащиеся объекты и настройки
        
1.5 Группа Options
    Global Position
        Переключает режим чтения координат точек геометрии между глобальным и локальными
    Global scale
        Множитель размера сцены при экспорте
    Visible only
        При включенной опции будут записаны только видимые во вьюпорте объекты. Объект будет исключен из экспорта если: у него выключена видимость (атрибут Visibility), если выключена видимость у родительского объекта, или если он находится в слое, который выключен
    Export hierarchy
        Позволяет экспортировать все объекты, вложенные по иерархии
        
1.5.1 Вкладка Polygons
    Poly Group
        Включенная опция создает примитивную группу для всех полигонов. Это позволит отделить полигональную геометрию от остальных типов. Текст из поля будет задействован как имя этой группы и префикс для всех полигональных групп
    Vertex attributes
        Вертексные атрибуты, экспорт которых поддерживает скрипт
            UV 
                Uv координаты. Поддерживается любое количество UV сетов на геометрии. Создает атрибут формата Vector3
                Контекстное меню данной опции позволяет выбрать тип именования атрибутов.
                uv, uv1, uv2...
                    этот тип именования задаёт всем сетам имя, принятое в Houdini как атрибут UV координат. Первый сет будет назван как "uv", остальные будт в конце иметь порядковый номер. Данный тип именования поддерживается нодой LayerSOP
                uv, uv_<setName>,uv_<setName>
                    этот тип именования задаёт имя первому uv сету как "uv", чтобы данный атрибут сразу считался в Houdini как uv координаты. остальные сеты получают имя, соответствующее имени uv сета в Maya, с превиксом "uv_"
                uv_<setName>,uv_<setName>,uv_<setName>
                    Все uv сеты получают имя атрибута, соответствующее имени сета с префиксом "uv_"
            Color
                Запись Vertex Color как вертексный атрибут цвета "Cd", формат Vector3. Поддерживается любое количество цветовых сетов. Контекстное меню работает так же, как в редыдущей опции.
            Vertex Normal
                Запись вертексных нормалей для передачи Hard\Soft Edges. Создается вертексный атрибут "N" Vector3
            Edge Crease
                Запись параметров криза с рёбер. Вертексные кризы не поддерживаются. Создает вертексный атрибут "creaseweight" float
    Prim attributes
        Строка для ввода имен атрибутов, которые следует экспортировать
    Groups
        Опции, которые включают генерацию групп по нескольким алгоритмам
            Поле состоит из трёх столбцов
            - Prim group by:
                Включает или выключает генерацию конкретного типа группы
            - Prefix:
                Текст из этого поля будет задействован как префикс имени группы
            - Filter:
                В это поле можно записывать имя или часть имени объекта, которые нужно обработать. Не попадающие под фильтр объекты будут записаны в одну общую группу
            Типы групп:
            - Material
                Каждый полигон попадает в группу с именем материала, который на него назначен.
            - Object Name
                Каждый объект попадет в отдельную группу с именем этого объекта. При совпадении имен, объекты попадают в одну группу
            - Shape name
                В группу попадают объекты, у которых одинаковое имя шейп-ноды. Обычно это Инстанс-объекты. Так же могут попасть просто копии объектов, находящиеся на разных уровнях иерархии и имеющие одинаковые имена
            - Parent
                Объекты попадают в группу, имя которой дает родительская нода. Объекты, являющиеся потомками одной ноды, попадают в одну группу. Фильтр в данном случае не просто фильтрует имена родительских нод, но и ищет имя по иерархии до самого верха, пока не найдет совпадение. Если совпадение не найдено, объект попадает в общую группу
            - Display Layer
                Группы генерируются исходя из состава слоёв. Все объекты, находящиеся в конкретном слое, попадают в одну группу с именем этого слоя

1.5.2 Вкладка Curves
    Поддерживаются любые NURBS кривые. В Houdini они будут являтсья NURBS примитивами
    Curves Group
        Опция включает создание примитивной группы, общей для всех кривых. Текст из поля будет использован как имя группы,  а так же префикс для всех групп данного типа
    NURBS\Polyline
        Переключает метод записи кривых: как NURBS кривые или как полигональные примитивы
    Groups
        Object Name
            Для каждой отдельной кривой будет создана отдельная группа
        Parent
            Объекты попадают в группу, имя которой дает родительская нода. Объекты, являющиеся потомками одной ноды, попадают в одну группу
        Display layer
            Группы генерируются исходя из слоёв. Все объекты, находящиеся в конкретном слое, попадают в одну группу с именем этого слоя

1.5.3 Вкладка Particles
    Particles group
        Опция включает генерацию общей поинт-группы для частиц. Текст из поля будет именем группы, а так же префиксом всех групп для частиц
    Particle attributes
        Поле для ввода имен атрибутов, которые необходимо включить в экспорт
    Groups
        Object name
            В группу попадают все точки, пренадлежашие конкретной системе частиц
        Emitter
            Создаются группы по количеству емиттеров, и в каждую группу добавляются точки, система частиц которых привязанна к конкретному эмиттеру (не путать с понятием "выпущенная из конкретного эмиттера")

1.5.4 Вкладка Pivots
        Pivot Groups
            Опция, включающая генерацию поинт-группы для пивотов. Текст из поля будет использован как имя этой группы и префикс для всех групп пивотов.
        Object filter
            В поле можно написать имя или части имени объекта, который нужно считать как пивот. Если объект не попадает под фильтр, он будет игнорирован.
        Skip transform without shape
            При экспорте не будут учитываться ноды tranfsorm, не имеющие своей шейп-ноды, даже если внутри есть другие объекты
        Object Attributes
            Orient
                Атрибуты поворота записываются как атриут "orient" в формате Vector4. Этот атрибут автоматически применяется в Houdini как атрибут поворота для копируемых объектов в CopySOP или при инстансировании
            Scale
                Атрибут масштаба автоматически записывается как атрибут "scale" в формате Vector3. Этот атрибут применяется в Houdini для масштаба копируемой по точкам геометрии в CopySOP или при инстансировании
            Поле для ввода атрибутов, которые необходимо считать с ноды. Атрибуты будут записаны как атрибуты точки
        Groups
            Object name
                Точка попадет в группу с именем объекта, с которого она считана
            Shape name
                Точка попадет в группу с именем шейп-ноды объекта с которого она считана
            Parent
                Группа генерируется исходя из родительской ноды
                
1.6 Главное меню окна.
    Menu
        Основное меню окна
        Save settings...
            Сохраняет настройки выделенного сета в файл на диск
        Load settings...
            Загружает настройки из файла и применяет к выделенным сетам
        Default
            Применяет к выделенным сетам значения по умолчанию
        Save as default
            Сохраняет настройки выделенного сета как настройки по умолчанию. Внимание! Новые сеты будут создаваться с сохраненными настройками
        Extended report
            Расширеная отчетность в окне output. Может влиять на производиительность
        Isolate exported
            Во время экспорта изолирует содержимое сета с целью ускорения просчета сцены между кадрами
        Color indicators
            Включает отображение цветовых индикаторов для сетов
        Show warnings
            Включает отображение предупреждений о совпадении путей или о псустых полях с адресом сохранения файла в сетах
    Help
        Меню помощи
        Help
            Ссылка на страницу скрипта
        About
            Окно about
     
1.7 Кнопки
    Export
        Кнопка, запускающая процесс экспорта
    Длинная кнопка под окном output
        Очищает окно output
    Клавиша Esc
        Отменяет процесс экспорта
    
1.8 Цветовые индикаторы
    При наличии нескольких сетов, цветовые индикаторы помогут быстро увидеть основные настройки в них. Индикатор состоит из 8 маркеров, по 4 в ряду. Каждый из них означает включенную или выключенную определенную опцию.
      |  1  |  2  |  3  |  4  |
      |  5  |  6  |  7  |  8  |
    1 - Экспорт анмиации или одного кадра (on = range, off = single frame)
    2 - Тип файла (on = BGEO, off = GEO)
    3 - Тип анимации (on =  MDD, off = sequence)
    4 - Применение zip архивации (on = zip enable, off = zip disable)
    5 - Экспорт полигонов (on\off)
    6 - Экспорт кривых (on\off)
    7 - Экспорт частиц  (on\off)
    8 - Экспорт пивотов  (on\off)
    
                
1.9. Правила записи атрибутов для экспорта:
    Вкладки Polygons, Particles и Pivots имеют поля для ввода имен атрибутов для экспорта. В этом поле необходимо правильно вводить имена атрибутов. Имена разделять порбелами. Если атрибут не будет найден ни на одной ноде, он не будет создан. Если атрибут найден не на всех нодах, то на остальных объектах он будет иметь значение по умолчанию - 0 (для scale это 1). Если требуется другое значение по умолчанию, его нужно записать в скобках сразу после имени атрибута без пробелов. Для вектора или флоатного значения пишется всегда одно число. Для строковых атрибутов необходимо писать текст без ковычек.
